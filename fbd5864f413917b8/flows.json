[{"id":"fbd5864f413917b8","type":"tab","label":"[binary] parse PNG image data","disabled":false,"info":"## Parse PNG image data\n\nTesting the binary node.\n\nThis test is explained in more details in the [Exif removal](https://flows.red-erik.org/f/2990f23c277c4133) flow that combines this code with a HTTP endpoint.\n\n","env":[{"name":"ERED_ONLY","value":"true","type":"bool"}]},{"id":"946f8b7071350f5c","type":"group","z":"fbd5864f413917b8","name":"check for chunk types","style":{"label":true},"nodes":["67682850419014e1","4c22b23af758fd72","df8ec7e7aed2b88a","04f5234163f7cb11","20e71e42c1ecd950","2096192a0467b817"],"x":1523,"y":485.5,"w":152,"h":389.5},{"id":"f2bff1e480add50c","type":"template","z":"fbd5864f413917b8","name":"test png image","field":"payload","fieldType":"msg","format":"handlebars","syntax":"plain","template":"iVBORw0KGgoAAAANSUhEUgAAANwAAAALCAYAAAAUYeMWAAABR2lDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8nAwcDIIMQgw8CQmFxc4BgQ4ANUwgCjUcG3a0C1QHBZF2RWerziqj87zu2u0bx5S3Oh6xRM9SiAKyW1OBlI/wHitOSCohIGBsYUIFu5vKQAxO4AskWKgI4CsueA2OkQ9gYQOwnCPgJWExLkDGTfALIFkjMSgWYwvgCydZKQxNOR2FB7QYDHxdXHRyHUyNzQ0oWAc0kHJakVJSDaOb+gsigzPaNEwREYSqkKnnnJejoKRgZGpgwMoDCHqP4cBA5LRrF9CLH8JQwMFt8YGJgnIsSSgOG6vY2BQeIWQkxlHgMDfwsDw7ZDBYlFiXAHMH5jKU4zNoKweewZGFjv/v//WYOBgX0iA8Pfif///178///fxUDzbzMwHKgEAP/gYWGPEFrdAAAAVmVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAADkoYABwAAABIAAABEoAIABAAAAAEAAADcoAMABAAAAAEAAAALAAAAAEFTQ0lJAAAAU2NyZWVuc2hvdPQhYecAAAHVaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjExPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyMDwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlVzZXJDb21tZW50PlNjcmVlbnNob3Q8L2V4aWY6VXNlckNvbW1lbnQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgqz9P99AAAFMUlEQVRoBeWZW4iVVRTHzzE1uqllWYjUZOFYECVGkCEEhWZCVi8F5UvXh7CHIioVupFCEBJpUNqDZRfoZnZxympeMshIKkuyKKGw0RItSotup99/Zi9md/j22t/55hycbMNv9v72Xmvtdflu55t6rVZrwPBuR+JeHX4e3m4O2btRWPhjyFYObgOHEN5fHQ6xg3UY0WHX22P+Kcw83R5Tw9bKidxTdEOZUNLDWcjNLSlbVqwTNsvuXVZuG4LzygpXkGu1Di1uMbJF+QMjvpRt9YQ7mJvd+qzPxToHAT35X8sJtrDeCZstbF9KVE840alm+be+A/volbIcG5Drge2wE+4B053N+Dnogy1wLdjaNMabYRn8AJ/B8aD1blgLu0C694LpXcn408DiaF7r8mUNbAXpLQLTO4fxW7AHNsEOuAZsPdV78XViv3n49CXsht5ao/4b/Qkg/2ZDKp+rWJOO4lN+HgKLydPrRi6Va8+mV78p2FSuf4R1MBNyvlyOzEfwOag+z4JqdB6YbqrXuad9iupexRft49XBs+nlJeV/NsBYUcG+A1Ph9nCCTGIsmelwAeiEWQp9MAq0RhH6T6Yexkrq3DCvtRfgdZgAEwO25xEcT4bnYTnYvHr58h4o6JtBBT8MtKYT4DGQb9+CbgyjIdYvGnvxdWK/r/DpSTgNHm664Lx8KlerQRek8nMsWDyenpdrz6ZXv2fY+1U4Ax6EbZDz5TpkfoEbQ8y6YWyEJWC6qd6rQxVftI9XB8+ml5eU/9kAY0UFq7uT5uqgp9z14XgE/UVwJ/Dk6b/ATgprOFbbB3ZBxDYXMr8f1sMCOBridY1XQdEFZ76wz7/260VeJ9cs+B4ugWabRcdefPFaO/Y7O/h8avCtKxzbE87Lp3zX28LKgrg8vVyuUzZT9RvD/j+BcqMb8eYQw7mM5WPKF11wyNZGBnlyUXscHoGiusRzqTpU9cWrQ85mKi+xv03j1t9U7beUNDX+HdRWwqOg+fdBTemz9jeDX+0g6pcwngZvw03QC602+7Jn+z2Ba/qgcBc8AK+0YDAVX2yiHftZ3szn5krk8hn7E489vaHkuqh+h5PnQ9l8DSyA+ZR8Ov3HoOb5onXZtKax5cLmcn1ch6q+eHXI2ZR/RXlx/G4usyMalm6jPx0Wkuwx9D1hXol+F9bB+aA2eqBz/05hVRfiCngJxsFQfxTjW2NjsKcT4mogeaVaKj5Pucp+n+BjH0YXwWS4r2mDXD73IX8W6KvmDLCceXq5XKdsYr6w7SSGLazo5jYedoBqvh/UPF8GJNr3t6ovXh1yNnPe66PW3XDKoGDrF9xxXGgfAidKYzmGdgVjy+gvZn7ToPH+i0eH+r9J6n8nt6LDp976XmQug1sKZIv04zm7U9oeusOeCRfCTFgBN0CZloqvE/vdj0NXEPtW+qnBOYvFy6dE18IkdL+hXw0TQc3Ty+U6ZTOOfWCXwb9XMfwTP94ETtDai6CbnFrKF7PHE62heO1Yfa6ZrOQsV6ZXxRfZ8erg2Yx9kZ3m1kVO7mBSN/yo6UFeDnt/Hof8+AIdvfMeUzCfs6+PI/bxJSebWx+LLf1enBP80PF3sDgce/q5+Ip0h7Kf7B0F+mBRZDuXT32Ust98sb6nl8t1ymZsv2isGIri8HwpstOOuSq+eHWQTymbnr9d6O2FGRDk9ItFB+XadsS4S/bfxcppHBipDWx7MshfPem+hvlwKaTayyy8AVXiq7rfFyln/qfzY4nbexNRjf5LOdNPrm74AEL7B4JsMAYZJUd2AAAAAElFTkSuQmCC","output":"base64","x":455,"y":299,"wires":[["c06c32509aae85c4"]]},{"id":"5ad1b5db23b1a926","type":"inject","z":"fbd5864f413917b8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":296,"y":134,"wires":[["f2bff1e480add50c"]]},{"id":"c06c32509aae85c4","type":"binary","z":"fbd5864f413917b8","name":"skim off png header","property":"payload","pattern":"x8 => 0x89,\nx8 => 0x50,\nx8 => 0x4E,\nx8 => 0x47,\nx8 => 0x0D,\nx8 => 0x0A,\nx8 => 0x1A,\nx8 => 0x0A\n","x":640,"y":444.5,"wires":[["25c7796333878d71"]]},{"id":"25c7796333878d71","type":"change","z":"fbd5864f413917b8","name":"","rules":[{"p":"payload","pt":"msg","t":"set","to":"rest","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":823,"y":575,"wires":[["d42c5e85ae72ba7c"]]},{"id":"d42c5e85ae72ba7c","type":"binary","z":"fbd5864f413917b8","name":"read chunk","property":"payload","pattern":"b32         => length,\nb8[4]       => type,\nb8[$length] => data,\nb32         => crc","x":1036,"y":681,"wires":[["5452ee464928f91f","7bb24454477d672e"]]},{"id":"5452ee464928f91f","type":"change","z":"fbd5864f413917b8","name":"","rules":[{"p":"payload","pt":"msg","t":"set","to":"rest","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":813,"y":866,"wires":[["6531918b9df64996"]]},{"id":"6531918b9df64996","type":"switch","z":"fbd5864f413917b8","name":"data left?","property":"payload","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"false","repair":false,"outputs":1,"x":1266,"y":864,"wires":[["d42c5e85ae72ba7c"]]},{"id":"7bb24454477d672e","type":"change","z":"fbd5864f413917b8","name":"","rules":[{"p":"payload.type","pt":"msg","t":"set","to":"$toString($$.payload.type)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1304,"y":526,"wires":[["4c1010d51d690ab5","0f32f797abb83827","67682850419014e1","4c22b23af758fd72","df8ec7e7aed2b88a","04f5234163f7cb11","20e71e42c1ecd950","2096192a0467b817"]]},{"id":"4c1010d51d690ab5","type":"join","z":"fbd5864f413917b8","name":"","mode":"custom","build":"array","property":"payload","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"6","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1563,"y":436.5,"wires":[["a61479fe85a35521"]]},{"id":"0f32f797abb83827","type":"join","z":"fbd5864f413917b8","name":"","mode":"custom","build":"array","property":"payload","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"7","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1564,"y":391.5,"wires":[["1b7af7e5f7ce7524"]]},{"id":"1b7af7e5f7ce7524","type":"ut-assert-failure","z":"fbd5864f413917b8","name":"","x":1731,"y":363.5,"wires":[]},{"id":"a61479fe85a35521","type":"ut-assert-success","z":"fbd5864f413917b8","name":"","x":1766,"y":436.5,"wires":[]},{"id":"67682850419014e1","type":"ut-assert-values","z":"fbd5864f413917b8","g":"946f8b7071350f5c","name":"IDAT","ignore_failure_if_succeed":true,"rules":[{"p":"payload.type","pt":"msg","t":"eql","to":"IDAT","tot":"str"}],"x":1599,"y":526.5,"wires":[[]]},{"id":"4c22b23af758fd72","type":"ut-assert-values","z":"fbd5864f413917b8","g":"946f8b7071350f5c","name":"eXIf","ignore_failure_if_succeed":true,"rules":[{"p":"payload.type","pt":"msg","t":"eql","to":"eXIf","tot":"str"}],"x":1599,"y":588,"wires":[[]]},{"id":"df8ec7e7aed2b88a","type":"ut-assert-values","z":"fbd5864f413917b8","g":"946f8b7071350f5c","name":"iCCP","ignore_failure_if_succeed":true,"rules":[{"p":"payload.type","pt":"msg","t":"eql","to":"iCCP","tot":"str"}],"x":1599,"y":649.5,"wires":[[]]},{"id":"04f5234163f7cb11","type":"ut-assert-values","z":"fbd5864f413917b8","g":"946f8b7071350f5c","name":"IHDR","ignore_failure_if_succeed":true,"rules":[{"p":"payload.type","pt":"msg","t":"eql","to":"IHDR","tot":"str"}],"x":1599,"y":711,"wires":[[]]},{"id":"20e71e42c1ecd950","type":"ut-assert-values","z":"fbd5864f413917b8","g":"946f8b7071350f5c","name":"iTXt","ignore_failure_if_succeed":true,"rules":[{"p":"payload.type","pt":"msg","t":"eql","to":"iTXt","tot":"str"}],"x":1599,"y":772.5,"wires":[[]]},{"id":"2096192a0467b817","type":"ut-assert-values","z":"fbd5864f413917b8","g":"946f8b7071350f5c","name":"IEND","ignore_failure_if_succeed":true,"rules":[{"p":"payload.type","pt":"msg","t":"eql","to":"IEND","tot":"str"}],"x":1599,"y":834,"wires":[[]]}]