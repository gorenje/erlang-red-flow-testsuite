[{"id":"b6d4e4592b27a344","type":"tab","label":"[link nodes] implement time out on link call node","disabled":false,"info":"## Link call node timeout handling\n\nA link call node has a separate timeout that ensures that a link call does not wait on broken nodes.\n\nTimeout has to be message specific since each message takes its own time.\n\nTimeout is a node setting that applied to all messages but the execution of that timeout is message specific.\n\nHowever: a delayed message is delivered nonetheless - here two messages are delivered. This is the <a class=\"ahl-group-only\" data-ids=\"44e9ce554cf08fe7\">timeout is triggered</a> test where the exception is triggered when the timeout runs out but three seconds, the message arrives anyway.\n\nIn the <a class=\"ahl-group-only\" data-ids=\"7bb323c70334a905\">timeout isn't triggered</a> test the timeout isn't triggered because the message arrived in time and the time out was cancelled.\n\n## Zero timeout\n\nNegative and zero timeouts are also supported and they trigger \"immediately\" but not immediately enough for Erlang.\n\nTherefore the catch nodes in <a class=\"ahl-group-only\" data-ids=\"4599cf7f6c29a5bd\">0 timeout is triggered immediately</a> and <a class=\"ahl-group-only\" data-ids=\"042b8a1e397ad7e5\">negative timeout becomes zero timeout</a> are FYIs not checked if they are reached.\n\nSometimes the timeout is fired before it is cancelled by the message arriving. It all depends on message queue ordering for the process representing the link call node.\n\nThe <a class=\"ahl-group-only\" data-ids=\"dc7dcfa7ee924a17\">delay is longer than test timeout, no message received</a> is a test that relays on this test case being terminated in ten seconds. Therefore the delay of 20 seconds is longer than the test and therefore the message is never received by the link call node. Hence the test passes.","env":[{"name":"ERED_TIMEOUT","value":"10","type":"num"},{"name":"ERED_PENDING","value":"false","type":"bool"}]},{"id":"44e9ce554cf08fe7","type":"group","z":"b6d4e4592b27a344","name":"timeout is triggered","style":{"label":true},"nodes":["619a6a95f2109be9","5866dc9633d00318","d4bfe1b9020910ba","6c93b763c3488caa","19bace4522dc5226","663515509fc28563","78ddfe144704367d","db745a894f71346d","a5074a5c98ed0ae0","b5be40f3f0719bdd"],"x":91,"y":116,"w":961,"h":354.5},{"id":"7bb323c70334a905","type":"group","z":"b6d4e4592b27a344","name":"timeout isn't triggered","style":{"label":true},"nodes":["2069c8a2cc0a898e","1a7b42c329316359","1f140bdf93070280","c886d4444c7c0080","30797d5378b94e8f","ada2660c774f8bee","76acee87d410603a","4833feee97dd3446","5e45a24a1fa409ec"],"x":94,"y":519,"w":906,"h":344.5},{"id":"4599cf7f6c29a5bd","type":"group","z":"b6d4e4592b27a344","name":"0 timeout is triggered immediately","style":{"label":true},"nodes":["69e28473e895dbb6","b68b751990acd0d8","ad52cdcab0b1d6b0","82d4ab7edb85790b","6e051e0de08f26fc","6ff879d740f4fef4","44d387a494495e4b","01e3250501bb70aa"],"x":81,"y":1078,"w":961,"h":245.75},{"id":"042b8a1e397ad7e5","type":"group","z":"b6d4e4592b27a344","name":"negative timeout becomes zero timeout","style":{"label":true},"nodes":["2f1abc47aa3d7bbc","b17373b482d33f33","a5f294aae286bd40","2064a184740e6c58","e2ab9e047f97418b","cd8d6264f821536e","82a52d5261e1ec21","833f6e8074205816","5e52d98a3a638b6f"],"x":83,"y":1401,"w":961,"h":246.25},{"id":"dc7dcfa7ee924a17","type":"group","z":"b6d4e4592b27a344","name":"delay is longer than test timeout, no message received","style":{"label":true},"nodes":["3ca52e0762154036","59c7405b5fa3a950","08317409b8ed6e74","c1236d6d5cfb3e9d","564dc6f1abedd201","73393b8dc31ef0f2","72d0dc67a267b676","fd7a2cc564103b6a","7f190b33178ac912"],"x":72,"y":1841,"w":875,"h":354.5},{"id":"619a6a95f2109be9","type":"inject","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"this is the payload","payloadType":"str","x":227,"y":304,"wires":[["6c93b763c3488caa"]]},{"id":"5866dc9633d00318","type":"link in","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"link in 6","links":[],"x":275,"y":429.5,"wires":[["78ddfe144704367d"]]},{"id":"d4bfe1b9020910ba","type":"link out","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"link out 4","mode":"return","links":[],"x":618,"y":429.5,"wires":[]},{"id":"6c93b763c3488caa","type":"link call","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"two second timeout","links":["5866dc9633d00318"],"linkType":"static","timeout":"2","x":590,"y":304,"wires":[["19bace4522dc5226","663515509fc28563"]]},{"id":"19bace4522dc5226","type":"ut-assert-values","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"","rules":[{"t":"eql","p":"payload","pt":"msg","to":"this is the payload","tot":"str"}],"x":936,"y":304,"wires":[[]]},{"id":"663515509fc28563","type":"ut-assert-success","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"","x":866,"y":356,"wires":[]},{"id":"78ddfe144704367d","type":"delay","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":438,"y":429.5,"wires":[["d4bfe1b9020910ba"]]},{"id":"db745a894f71346d","type":"catch","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"catch timeout event","scope":["6c93b763c3488caa"],"uncaught":false,"x":446,"y":211,"wires":[["a5074a5c98ed0ae0","b5be40f3f0719bdd"]]},{"id":"a5074a5c98ed0ae0","type":"ut-assert-success","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"","x":718,"y":157,"wires":[]},{"id":"b5be40f3f0719bdd","type":"ut-assert-values","z":"b6d4e4592b27a344","g":"44e9ce554cf08fe7","name":"","rules":[{"t":"eql","p":"payload","pt":"msg","to":"this is the payload","tot":"str"}],"x":695,"y":211,"wires":[[]]},{"id":"2069c8a2cc0a898e","type":"inject","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"this is the payload","payloadType":"str","x":230,"y":677,"wires":[["c886d4444c7c0080"]]},{"id":"1a7b42c329316359","type":"link in","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"link in 13","links":[],"x":278,"y":822.5,"wires":[["76acee87d410603a"]]},{"id":"1f140bdf93070280","type":"link out","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"link out 142","mode":"return","links":[],"x":621,"y":822.5,"wires":[]},{"id":"c886d4444c7c0080","type":"link call","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"five second timeout","links":["1a7b42c329316359"],"linkType":"static","timeout":"5","x":583,"y":677,"wires":[["30797d5378b94e8f","ada2660c774f8bee"]]},{"id":"30797d5378b94e8f","type":"ut-assert-values","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"","rules":[{"t":"eql","p":"payload","pt":"msg","to":"this is the payload","tot":"str"}],"x":884,"y":677,"wires":[[]]},{"id":"ada2660c774f8bee","type":"ut-assert-success","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"","x":852,"y":733,"wires":[]},{"id":"76acee87d410603a","type":"delay","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":441,"y":822.5,"wires":[["1f140bdf93070280"]]},{"id":"4833feee97dd3446","type":"catch","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"catch timeout event","scope":["c886d4444c7c0080"],"uncaught":false,"x":456,"y":560,"wires":[["5e45a24a1fa409ec"]]},{"id":"5e45a24a1fa409ec","type":"ut-assert-failure","z":"b6d4e4592b27a344","g":"7bb323c70334a905","name":"","x":781,"y":560,"wires":[]},{"id":"69e28473e895dbb6","type":"inject","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"this is the payload","payloadType":"str","x":217,"y":1212,"wires":[["82d4ab7edb85790b"]]},{"id":"b68b751990acd0d8","type":"link in","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"link in 1","links":[],"x":265,"y":1282.75,"wires":[["ad52cdcab0b1d6b0"]]},{"id":"ad52cdcab0b1d6b0","type":"link out","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"link out 1","mode":"return","links":[],"x":608,"y":1282.75,"wires":[]},{"id":"82d4ab7edb85790b","type":"link call","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"zero second timeout","links":["b68b751990acd0d8"],"linkType":"static","timeout":"0","x":580,"y":1212,"wires":[["6e051e0de08f26fc","6ff879d740f4fef4"]]},{"id":"6e051e0de08f26fc","type":"ut-assert-values","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"","rules":[{"t":"eql","p":"payload","pt":"msg","to":"this is the payload","tot":"str"}],"x":926,"y":1212,"wires":[[]]},{"id":"6ff879d740f4fef4","type":"ut-assert-success","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"","x":863,"y":1282.75,"wires":[]},{"id":"2f1abc47aa3d7bbc","type":"inject","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"this is the payload","payloadType":"str","x":219,"y":1515,"wires":[["2064a184740e6c58"]]},{"id":"b17373b482d33f33","type":"link in","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"link in 2","links":[],"x":204,"y":1606.25,"wires":[["a5f294aae286bd40","82a52d5261e1ec21"]]},{"id":"a5f294aae286bd40","type":"link out","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"link out 2","mode":"return","links":[],"x":547,"y":1606.25,"wires":[]},{"id":"2064a184740e6c58","type":"link call","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"negative ten second timeout","links":["b17373b482d33f33"],"linkType":"static","timeout":"-10","x":602,"y":1515,"wires":[["e2ab9e047f97418b","cd8d6264f821536e"]]},{"id":"e2ab9e047f97418b","type":"ut-assert-values","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"","rules":[{"t":"eql","p":"payload","pt":"msg","to":"this is the payload","tot":"str"}],"x":928,"y":1515,"wires":[[]]},{"id":"cd8d6264f821536e","type":"ut-assert-success","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"","x":912,"y":1591.25,"wires":[]},{"id":"3ca52e0762154036","type":"inject","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"this is the payload","payloadType":"str","x":208,"y":2029.75,"wires":[["c1236d6d5cfb3e9d"]]},{"id":"59c7405b5fa3a950","type":"link in","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"link in 3","links":[],"x":256,"y":2154.5,"wires":[["564dc6f1abedd201"]]},{"id":"08317409b8ed6e74","type":"link out","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"link out 3","mode":"return","links":[],"x":599,"y":2154.5,"wires":[]},{"id":"c1236d6d5cfb3e9d","type":"link call","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"two second timeout","links":["59c7405b5fa3a950"],"linkType":"static","timeout":"2","x":571,"y":2029.75,"wires":[["7f190b33178ac912"]]},{"id":"564dc6f1abedd201","type":"delay","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":419,"y":2154.5,"wires":[["08317409b8ed6e74"]]},{"id":"73393b8dc31ef0f2","type":"catch","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"catch timeout event","scope":["c1236d6d5cfb3e9d"],"uncaught":false,"x":427,"y":1936,"wires":[["72d0dc67a267b676","fd7a2cc564103b6a"]]},{"id":"72d0dc67a267b676","type":"ut-assert-success","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"","x":699,"y":1882,"wires":[]},{"id":"fd7a2cc564103b6a","type":"ut-assert-values","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"","rules":[{"t":"eql","p":"payload","pt":"msg","to":"this is the payload","tot":"str"}],"x":676,"y":1936,"wires":[[]]},{"id":"7f190b33178ac912","type":"ut-assert-failure","z":"b6d4e4592b27a344","g":"dc7dcfa7ee924a17","name":"","x":851,"y":2029.75,"wires":[]},{"id":"82a52d5261e1ec21","type":"debug","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"test encoding of TReference","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":409,"y":1570,"wires":[]},{"id":"44d387a494495e4b","type":"catch","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"catch timeout event","scope":["82d4ab7edb85790b"],"uncaught":false,"x":436,"y":1119,"wires":[["01e3250501bb70aa"]]},{"id":"833f6e8074205816","type":"catch","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"catch timeout event","scope":["2064a184740e6c58"],"uncaught":false,"x":420,"y":1442,"wires":[["5e52d98a3a638b6f"]]},{"id":"01e3250501bb70aa","type":"debug","z":"b6d4e4592b27a344","g":"4599cf7f6c29a5bd","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":833,"y":1120,"wires":[]},{"id":"5e52d98a3a638b6f","type":"debug","z":"b6d4e4592b27a344","g":"042b8a1e397ad7e5","name":"debug 2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":808,"y":1443,"wires":[]}]