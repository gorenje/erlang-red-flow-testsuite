[{"disabled":false,"env":[{"name":"ERED_TIMEOUT","type":"num","value":"4"}],"id":"dd3a287f4b66745a","info":"## Statemachines need actions\n\nIt is an error if a message is sent to an statemachine and no action is defined.\n\nThe statemachine node raises an exception that can be captured or is sent to the debug panel if not captured.","label":"[statemachine] exception if no action to perform","type":"tab"},{"h":161,"id":"219c4860668ffeb6","name":"no action and no payload","nodes":["ff00e922e9c9859f","7fe03593dc9b5036","6fc1ce91f7c49594","9cac9a2975f9b8ac"],"style":{"label":true},"type":"group","w":1146,"x":218,"y":405,"z":"dd3a287f4b66745a"},{"h":161,"id":"4f6089aa3d5f7229","name":"no action but payload","nodes":["cdb9ecf983a7b981","6549d77fda872346","0a354df5f0421672","c450e90d1a582c51"],"style":{"label":true},"type":"group","w":1158,"x":218,"y":616,"z":"dd3a287f4b66745a"},{"h":167,"id":"ae18f60d92cbeab2","name":"no action and no payload","nodes":["fc49f96f7443c0f7","1a0642cf66c03f8b","b6ad34c8434e67a5","39534782b5a0ab5f","036fe945e28fa95f","1db584e1c66a874a"],"style":{"label":true},"type":"group","w":1051,"x":218,"y":811,"z":"dd3a287f4b66745a"},{"h":172,"id":"20bff1405f3419d3","name":"no action but payload","nodes":["c3f6efe5c2c48cc8","a41f398cd9535ad6","a2887f9cf9f46bc7","c4d12f45eee64463","63d8c6199839dccf","8b46dc9459b596c7"],"style":{"label":true},"type":"group","w":999,"x":218,"y":1017,"z":"dd3a287f4b66745a"},{"code":"-module(statemachine_message_no_action).\n\n-behaviour(gen_statem).\n\n-export([\n    start/0,\n    init/1,\n    callback_mode/0,\n    handle_event/4,\n    code_change/4,\n    terminate/3,\n    stop/0\n]).\n\ncallback_mode() -> handle_event_function.\n\n%% API.  This example uses a registered name name()\n%% and does not link to the caller.\nstart() ->\n    gen_statem:start({local, ?MODULE}, ?MODULE, [], []).\n\ninit([]) ->\n    State = disconnected,\n    Data = 0,\n    {ok, State, Data}.\n\n%% Mandatory callback functions\nstop() ->\n    gen_statem:stop(?MODULE).\nterminate(_Reason, _State, _Data) ->\n    void.\ncode_change(_Vsn, State, Data, _Extra) ->\n    {ok,State,Data}.\n\n%%\n%% handler function for state transistions\n%%\n\n%%\n%% Do not much. Increment counter and return the value on each call.\n%%\nhandle_event(\n  {call, From},\n  {<<\"donothing\">>, <<\"donothing\">>},\n  disconnected,\n  Data\n) ->\n    {keep_state, \n        Data+1, \n            [{reply, \n              From, \n              list_to_binary(io_lib:format(\"count ~p\", [Data+1]))\n              }\n            ]}.\n\n","id":"44281387f23671f5","module_name":"statemachine_message_no_action","name":"","type":"erlmodule","wires":[],"x":392,"y":233,"z":"dd3a287f4b66745a"},{"emit_on_state_change":false,"g":"219c4860668ffeb6","id":"ff00e922e9c9859f","name":"","scope":["44281387f23671f5"],"type":"erlstatemachine","wires":[[]],"x":720,"y":446,"z":"dd3a287f4b66745a"},{"crontab":"","g":"219c4860668ffeb6","id":"7fe03593dc9b5036","name":"","once":false,"onceDelay":0.1,"props":[],"repeat":"","topic":"","type":"inject","wires":[["ff00e922e9c9859f"]],"x":314,"y":525,"z":"dd3a287f4b66745a"},{"g":"219c4860668ffeb6","id":"6fc1ce91f7c49594","inverse":false,"msgtype":"error","name":"","nodeid":"ff00e922e9c9859f","scope":["ff00e922e9c9859f"],"type":"ut-assert-debug","wires":[["9cac9a2975f9b8ac"]],"x":851,"y":525,"z":"dd3a287f4b66745a"},{"emit_on_state_change":false,"g":"4f6089aa3d5f7229","id":"cdb9ecf983a7b981","name":"","scope":["44281387f23671f5"],"type":"erlstatemachine","wires":[[]],"x":710,"y":657,"z":"dd3a287f4b66745a"},{"crontab":"","g":"4f6089aa3d5f7229","id":"6549d77fda872346","name":"","once":false,"onceDelay":0.1,"payload":"fubar","payloadType":"str","props":[{"p":"payload"}],"repeat":"","topic":"","type":"inject","wires":[["cdb9ecf983a7b981"]],"x":314,"y":736,"z":"dd3a287f4b66745a"},{"g":"4f6089aa3d5f7229","id":"0a354df5f0421672","inverse":false,"msgtype":"error","name":"","nodeid":"cdb9ecf983a7b981","scope":["cdb9ecf983a7b981"],"type":"ut-assert-debug","wires":[["c450e90d1a582c51"]],"x":841,"y":736,"z":"dd3a287f4b66745a"},{"g":"ae18f60d92cbeab2","id":"39534782b5a0ab5f","name":"","scope":["fc49f96f7443c0f7"],"type":"catch","uncaught":false,"wires":[["036fe945e28fa95f"]],"x":901,"y":852,"z":"dd3a287f4b66745a"},{"emit_on_state_change":false,"g":"ae18f60d92cbeab2","id":"fc49f96f7443c0f7","name":"","scope":["44281387f23671f5"],"type":"erlstatemachine","wires":[[]],"x":678,"y":852,"z":"dd3a287f4b66745a"},{"crontab":"","g":"ae18f60d92cbeab2","id":"1a0642cf66c03f8b","name":"","once":false,"onceDelay":0.1,"props":[],"repeat":"","topic":"","type":"inject","wires":[["fc49f96f7443c0f7"]],"x":314,"y":937,"z":"dd3a287f4b66745a"},{"g":"ae18f60d92cbeab2","id":"b6ad34c8434e67a5","inverse":true,"msgtype":"error","name":"","nodeid":"fc49f96f7443c0f7","scope":["fc49f96f7443c0f7"],"type":"ut-assert-debug","wires":[["1db584e1c66a874a"]],"x":789,"y":937,"z":"dd3a287f4b66745a"},{"emit_on_state_change":false,"g":"20bff1405f3419d3","id":"c3f6efe5c2c48cc8","name":"","scope":["44281387f23671f5"],"type":"erlstatemachine","wires":[[]],"x":668,"y":1058,"z":"dd3a287f4b66745a"},{"crontab":"","g":"20bff1405f3419d3","id":"a41f398cd9535ad6","name":"","once":false,"onceDelay":0.1,"payload":"fubar","payloadType":"str","props":[{"p":"payload"}],"repeat":"","topic":"","type":"inject","wires":[["c3f6efe5c2c48cc8"]],"x":314,"y":1148,"z":"dd3a287f4b66745a"},{"g":"20bff1405f3419d3","id":"a2887f9cf9f46bc7","inverse":true,"msgtype":"error","name":"","nodeid":"c3f6efe5c2c48cc8","scope":["c3f6efe5c2c48cc8"],"type":"ut-assert-debug","wires":[["8b46dc9459b596c7"]],"x":779,"y":1148,"z":"dd3a287f4b66745a"},{"g":"20bff1405f3419d3","id":"c4d12f45eee64463","name":"","scope":["c3f6efe5c2c48cc8"],"type":"catch","uncaught":false,"wires":[["63d8c6199839dccf"]],"x":896,"y":1058,"z":"dd3a287f4b66745a"},{"count":1,"g":"20bff1405f3419d3","id":"63d8c6199839dccf","name":"","type":"ut-assert-success","wires":[],"x":1121,"y":1058,"z":"dd3a287f4b66745a"},{"count":1,"g":"ae18f60d92cbeab2","id":"036fe945e28fa95f","name":"","type":"ut-assert-success","wires":[],"x":1173,"y":852,"z":"dd3a287f4b66745a"},{"g":"ae18f60d92cbeab2","id":"1db584e1c66a874a","name":"","type":"ut-assert-failure","wires":[],"x":1173,"y":937,"z":"dd3a287f4b66745a"},{"g":"20bff1405f3419d3","id":"8b46dc9459b596c7","name":"","type":"ut-assert-failure","wires":[],"x":1121,"y":1148,"z":"dd3a287f4b66745a"},{"g":"4f6089aa3d5f7229","id":"c450e90d1a582c51","ignore_failure_if_succeed":false,"name":"","rules":[{"p":"debug.nodeid","pt":"msg","t":"eql","to":"cdb9ecf983a7b981","tot":"str"},{"p":"debug.type","pt":"msg","t":"eql","to":"error","tot":"str"},{"p":"payload['level']","pt":"msg","t":"eql","to":"20","tot":"num"},{"p":"payload.format","pt":"msg","t":"eql","to":"object","tot":"str"},{"p":"payload.id","pt":"msg","t":"eql","to":"cdb9ecf983a7b981","tot":"str"},{"p":"payload.msg.error_msg","pt":"msg","t":"eql","to":"no action to perform","tot":"str"}],"type":"ut-assert-values","wires":[[]],"x":1270,"y":736,"z":"dd3a287f4b66745a"},{"g":"219c4860668ffeb6","id":"9cac9a2975f9b8ac","ignore_failure_if_succeed":false,"name":"","rules":[{"p":"debug.nodeid","pt":"msg","t":"eql","to":"ff00e922e9c9859f","tot":"str"},{"p":"debug.type","pt":"msg","t":"eql","to":"error","tot":"str"},{"p":"payload['level']","pt":"msg","t":"eql","to":"20","tot":"num"},{"p":"payload.format","pt":"msg","t":"eql","to":"object","tot":"str"},{"p":"payload.id","pt":"msg","t":"eql","to":"ff00e922e9c9859f","tot":"str"},{"p":"payload.msg.error_msg","pt":"msg","t":"eql","to":"no action to perform","tot":"str"}],"type":"ut-assert-values","wires":[[]],"x":1258,"y":525,"z":"dd3a287f4b66745a"}]